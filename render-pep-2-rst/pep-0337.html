<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/peps/pep-0001.html for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<head>
  <title>PEP 337 -- Logging Usage in the Standard Library</title>
  <link rel="STYLESHEET" href="style.css" type="text/css" />
</head>
<body bgcolor="white">
<table class="navigation" cellpadding="0" cellspacing="0"
       width="100%" border="0">
<tr><td class="navicon" width="150" height="35">
<a href="../" title="Python Home Page">
<img src="../pics/PyBanner030.gif" alt="[Python]"
 border="0" width="150" height="35" /></a></td>
<td class="textlinks" align="left">
[<b><a href="../">Python Home</a></b>]
[<b><a href=".">PEP Index</a></b>]
[<b><a href="pep-0337.txt">PEP Source</a></b>]
</td></tr></table>
<div class="header">
<table border="0">
  <tr><th>PEP:&nbsp;</th><td>337</td></tr>
  <tr><th>Title:&nbsp;</th><td>Logging Usage in the Standard Library</td></tr>
  <tr><th>Version:&nbsp;</th><td>$Revision$</td></tr>
  <tr><th>Last-Modified:&nbsp;</th><td><a href="https://hg.python.org/peps/file/tip/pep-0337.txt">$Date$</a> </td></tr>
  <tr><th>Author:&nbsp;</th><td>Michael P. Dubner &lt;dubnerm&#32;&#97;t&#32;mindless.com&gt;</td></tr>
  <tr><th>Status:&nbsp;</th><td>Deferred</td></tr>
  <tr><th>Type:&nbsp;</th><td>Standards Track</td></tr>
  <tr><th>Content-Type:&nbsp;</th><td><a href="pep-0009.html">text/plain</a> </td></tr>
  <tr><th>Created:&nbsp;</th><td>02-Oct-2004</td></tr>
  <tr><th>Python-Version:&nbsp;</th><td>2.5</td></tr>
  <tr><th>Post-History:&nbsp;</th><td>10-Nov-2004</td></tr>
</table>
</div>
<hr />
<div class="content">
<h3>Abstract</h3>
<pre>
    This PEP defines a standard for using the logging system (<a href="pep-0282.html">PEP 282</a>
    [1]) in the standard library.

    Implementing this PEP will simplify development of daemon
    applications.  As a downside this PEP requires slight
    modifications (however in a back-portable way) to a large number
    of standard modules.

    After implementing this PEP one can use following filtering
    scheme:

        logging.getLogger(&#x27;py.BaseHTTPServer&#x27;).setLevel(logging.FATAL)

</pre>
<h3>PEP Deferral</h3>
<pre>
    Further exploration of the concepts covered in this PEP has been deferred
    for lack of a current champion interested in promoting the goals of the
    PEP and collecting and incorporating feedback, and with sufficient
    available time to do so effectively.


</pre>
<h3>Rationale</h3>
<pre>
    There are a couple of situations when output to stdout or stderr
    is impractical:

    - Daemon applications where the framework doesn&#x27;t allow the
      redirection of standard output to some file, but assumes use of
      some other form of logging.  Examples are syslog under *nix&#x27;es
      and EventLog under WinNT+.

    - GUI applications which want to output every new log entry in
      separate pop-up window (i.e. fading OSD).

    Also sometimes applications want to filter output entries based on
    their source or severity.  This requirement can&#x27;t be implemented
    using simple redirection.

    Finally sometimes output needs to be marked with event timestamps,
    which can be accomplished with ease using the logging system.


</pre>
<h3>Proposal</h3>
<pre>
    Every module usable for daemon and GUI applications should be
    rewritten to use the logging system instead of &#x27;print&#x27; or
    &#x27;sys.stdout.write&#x27;.
    
    There should be code like this included in the beginning of every
    modified module:

        import logging

        _log = logging.getLogger(&#x27;py.&lt;module-name&gt;&#x27;)

    A prefix of &#x27;py.&#x27; [2] must be used by all modules included in the
    standard library distributed along with Python, and only by such
    modules (unverifiable).  The use of &quot;_log&quot; is intentional as we
    don&#x27;t want to auto-export it.  For modules that use log only in
    one class a logger can be created inside the class definition as
    follows:

        class XXX:

            __log = logging.getLogger(&#x27;py.&lt;module-name&gt;&#x27;)

    Then this class can create access methods to log to this private
    logger.

    So &quot;print&quot; and &quot;sys.std{out|err}.write&quot; statements should be
    replaced with &quot;_log.{debug|info}&quot;, and &quot;traceback.print_exception&quot;
    with &quot;_log.exception&quot; or sometimes &quot;_log.debug(&#x27;...&#x27;, exc_info=1)&quot;.


</pre>
<h3>Module List</h3>
<pre>
    Here is a (possibly incomplete) list of modules to be reworked:

    - asyncore (dispatcher.log, dispatcher.log_info)

    - BaseHTTPServer (BaseHTTPRequestHandler.log_request,
      BaseHTTPRequestHandler.log_error,
      BaseHTTPRequestHandler.log_message)

    - cgi (possibly - is cgi.log used by somebody?)

    - ftplib (if FTP.debugging)

    - gopherlib (get_directory)

    - httplib (HTTPResponse, HTTPConnection)

    - ihooks (_Verbose)

    - imaplib (IMAP4._mesg)

    - mhlib (MH.error)

    - nntplib (NNTP)

    - pipes (Template.makepipeline)

    - pkgutil (extend_path)

    - platform (_syscmd_ver)

    - poplib (if POP3._debugging)

    - profile (if Profile.verbose)

    - robotparser (_debug)

    - smtplib (if SGMLParser.verbose)

    - shlex (if shlex.debug)

    - smtpd (SMTPChannel/PureProxy where print &gt;&gt; DEBUGSTREAM)

    - smtplib (if SMTP.debuglevel)

    - SocketServer (BaseServer.handle_error)

    - telnetlib (if Telnet.debuglevel)

    - threading? (_Verbose._note, Thread.__bootstrap)

    - timeit (Timer.print_exc)

    - trace

    - uu (decode)

    Additionally there are a couple of modules with commented debug
    output or modules where debug output should be added.  For
    example:

    - urllib

    Finally possibly some modules should be extended to provide more
    debug information.


</pre>
<h3>Doubtful Modules</h3>
<pre>
    Listed here are modules that the community will propose for
    addition to the module list and modules that the community say
    should be removed from the module list.

    - tabnanny (check)


</pre>
<h3>Guidelines for Logging Usage</h3>
<pre>
    Also we can provide some recommendation to authors of library
    modules so they all follow the same format of naming loggers.  I
    propose that non-standard library modules should use loggers named
    after their full names, so a module &quot;spam&quot; in sub-package &quot;junk&quot;
    of package &quot;dummy&quot; will be named &quot;dummy.junk.spam&quot; and, of course,
    the &quot;__init__&quot; module of the same sub-package will have the logger
    name &quot;dummy.junk&quot;.


</pre>
<h3>References</h3>
<pre>
    [1] <a href="pep-0282.html">PEP 282</a>, A Logging System, Vinay Sajip, Trent Mick
        <a href="http://www.python.org/dev/peps/pep-0282/">http://www.python.org/dev/peps/pep-0282/</a>

    [2] <a href="http://mail.python.org/pipermail/python-dev/2004-October/049282.html">http://mail.python.org/pipermail/python-dev/2004-October/049282.html</a>


</pre>
<h3>Copyright</h3>
<pre>
    This document has been placed in the public domain.



</pre>
</div>
</body>
</html>
