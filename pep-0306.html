<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
                      "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<!--
This HTML is auto-generated.  DO NOT EDIT THIS FILE!  If you are writing a new
PEP, see http://www.python.org/peps/pep-0001.html for instructions and links
to templates.  DO NOT USE THIS HTML FILE AS YOUR TEMPLATE!
-->
<head>
  <title>PEP 306 -- How to Change Python&#x27;s Grammar</title>
  <link rel="STYLESHEET" href="style.css" type="text/css" />
</head>
<body bgcolor="white">
<table class="navigation" cellpadding="0" cellspacing="0"
       width="100%" border="0">
<tr><td class="navicon" width="150" height="35">
<a href="../" title="Python Home Page">
<img src="../pics/PyBanner031.gif" alt="[Python]"
 border="0" width="150" height="35" /></a></td>
<td class="textlinks" align="left">
[<b><a href="../">Python Home</a></b>]
[<b><a href=".">PEP Index</a></b>]
[<b><a href="pep-0306.txt">PEP Source</a></b>]
</td></tr></table>
<div class="header">
<table border="0">
  <tr><th>PEP:&nbsp;</th><td>306</td></tr>
  <tr><th>Title:&nbsp;</th><td>How to Change Python&#x27;s Grammar</td></tr>
  <tr><th>Version:&nbsp;</th><td>$Revision$</td></tr>
  <tr><th>Last-Modified:&nbsp;</th><td><a href="https://hg.python.org/peps/file/tip/pep-0306.txt">$Date$</a> </td></tr>
  <tr><th>Author:&nbsp;</th><td>Michael Hudson &lt;mwh&#32;&#97;t&#32;python.net&gt;, Jack Diederich &lt;jackdied&#32;&#97;t&#32;gmail.com&gt;, Nick Coghlan &lt;ncoghlan&#32;&#97;t&#32;gmail.com&gt;, Benjamin Peterson &lt;benjamin&#32;&#97;t&#32;python.org&gt;</td></tr>
  <tr><th>Status:&nbsp;</th><td>Withdrawn</td></tr>
  <tr><th>Type:&nbsp;</th><td>Informational</td></tr>
  <tr><th>Content-Type:&nbsp;</th><td><a href="pep-0009.html">text/plain</a> </td></tr>
  <tr><th>Created:&nbsp;</th><td>29-Jan-2003</td></tr>
  <tr><th>Post-History:&nbsp;</th><td>30-Jan-2003</td></tr>
</table>
</div>
<hr />
<div class="content">
<h3>Note</h3>
<pre>
    This PEP has been moved to the Python dev guide.


</pre>
<h3>Abstract</h3>
<pre>
    There&#x27;s more to changing Python&#x27;s grammar than editing
    Grammar/Grammar and Python/compile.c.  This PEP aims to be a
    checklist of places that must also be fixed.

    It is probably incomplete.  If you see omissions, just add them if
    you can -- you are not going to offend the author&#x27;s sense of
    ownership.  Otherwise submit a bug or patch and assign it to mwh.

    This PEP is not intended to be an instruction manual on Python
    grammar hacking, for several reasons.


</pre>
<h3>Rationale</h3>
<pre>
    People are getting this wrong all the time; it took well over a
    year before someone noticed[1] that adding the floor division
    operator (//) broke the parser module.


</pre>
<h3>Checklist</h3>
<pre>
    __ Grammar/Grammar: OK, you&#x27;d probably worked this one out :)

    __ Parser/Python.asdl may need changes to match the Grammar.  Run
       make to regenerate Include/Python-ast.h and
       Python/Python-ast.c.

    __ Python/ast.c will need changes to create the AST objects
       involved with the Grammar change.  Lib/compiler/ast.py will
       need matching changes to the pure-python AST objects.

    __ Parser/pgen needs to be rerun to regenerate Include/graminit.h
       and Python/graminit.c. (make should handle this for you.)

    __ Python/symbtable.c: This handles the symbol collection pass
       that happens immediately before the compilation pass.

    __ Python/compile.c: You will need to create or modify the
       compiler_* functions to generate opcodes for your productions.

    __ You may need to regenerate Lib/symbol.py and/or Lib/token.py
       and/or Lib/keyword.py.

    __ The parser module.  Add some of your new syntax to test_parser,
       bang on Modules/parsermodule.c until it passes.

    __ Add some usage of your new syntax to test_grammar.py

    __ The compiler package.  A good test is to compile the standard
       library and test suite with the compiler package and then check
       it runs.  Note that this only needs to be done in Python 2.x.

    __ If you&#x27;ve gone so far as to change the token structure of
       Python, then the Lib/tokenizer.py library module will need to
       be changed.

    __ Certain changes may require tweaks to the library module
       pyclbr.

    __ Documentation must be written!

    __ After everything&#x27;s been checked in, you&#x27;re likely to see a new
       change to Python/Python-ast.c.  This is because this
       (generated) file contains the SVN version of the source from
       which it was generated.  There&#x27;s no way to avoid this; you just
       have to submit this file separately.


</pre>
<h3>References</h3>
<pre>
    [1] SF Bug #676521, parser module validation failure
        <a href="http://www.python.org/sf/676521">http://www.python.org/sf/676521</a>


</pre>
<h3>Copyright</h3>
<pre>
    This document has been placed in the public domain.



</pre>
</div>
</body>
</html>
